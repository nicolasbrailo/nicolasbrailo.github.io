<!DOCTYPE html>
<html>
<head>

<link rel="icon" href="favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<title>Nico Brailovsky's blog</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/style.css">
</head>

<body>

<div id="siteheader">
<h1>Nico Brailovsky's blog</h1>

<div class="nav tabs is-full">
  <a class="is-center" href="/">Home</a>
  <a class="is-center" href="/blog/index.html">Blog</a>
  <a class="is-center"
     href="https://github.com/search?type=code&q=repo%3Anicolasbrailo%2Fnicolasbrailo.github.io%20sitesearch"
     onclick="togglesearch(); return false">Site search</a>
  <a class="is-center" href="/blog/history.html">Archive</a>
  <a class="is-center" href="/series.html">Series</a>
  <a class="is-center" href="/projects.html">Projects</a>
  <a class="is-center" href="/about.html">About</a>
</div>

<div id="sitesearch" class="nav tabs is-full is-hidden">
  <input type="text" id="sitesearch_q"/>
  <button onclick="dosearch()">Serach</button>
</div>

</div>

<div id="content" class="language-clike">
<h1>C preprocessor III: Token pasting<a name="cpreprocessoriiitokenpasting"></a></h1>
<p>A stringify operator is good but the token pasting operator goes off the awesomeness chart (if you're working on an ioccc entry, that is). Actually, what token pasting does is conceptually simple: it will paste together two tokens to form a new one. So, for example, PASTE(foo, bar) would result in the "foobar" token. Looks simple enough, doesn't it? The token pasting operator is invoked via '##'. For example:</p>
<pre lang="c++"><code class="language-c++" lang="c++">#define PASTE(x, y) x ## y
#define FOOBAR 42
int main() { return PASTE(FOO, BAR); }
</code></pre>
<p>The previous code would just return 42. So what's the usefulness of a paste operator? Other than obfuscating stuff, you can use it to create classes with similar interfaces but different method names (I'm not saying it's a good idea, I'm saying you can). For example:</p>
<pre lang="c++"><code class="language-c++" lang="c++">#define MAKE_GET_SET(x, T) \
               void set_ ## x (T o) { this-&gt;x = o; } \
               T get_ ## x () { return this-&gt;x; }
class Foo {
  MAKE_GET_SET(foo, int);
</code></pre>
<p>The token pasting operator doesn't have the limitation of being applicable only to a macro parameter, so code like "12 ## 34" is a perfectly valid operation which results in "1234". It does have a catch: if the resulting token is not valid the behavior is undefined. This means that, for example, pasting "12" and "foo" together produces "12foo", which is not a valid token. Being the operation undefined means that a compiler might reject this operation (I'm pretty sure gcc does) or that it might do a completely different thing (it could choose to ignore the token pasting operator and it would still be standard compliant).</p>
<p>Nasal demons FTW!</p>
<hr />
<p>Post by Nico Brailovsky @ 2013-09-02 -
    <a href="/blog/2013/0902_CpreprocessorIIITokenpasting.html">Permalink</a> -
    <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog_md/2013/0902_CpreprocessorIIITokenpasting.md&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
</div>

<div id="sitefooter">
Page generated 2024-02-05
</div>

<script src="/search.js"></script>
<script src="/codehighlight.js"></script>

</body>
</html>

<!DOCTYPE html>
<html>
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<title>Scope ending in C++ Nico Brailovsky's ideas repository</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/style.css">
</head>

<body>

<div id="siteheader">
  <h1>Nico Brailovsky's ideas repository</h1>

<div class="nav tabs is-full">
  <a class="is-center" href="/blog/index.html">Blog</a>
  <a class="is-center"
     href="https://github.com/search?type=code&q=repo%3Anicolasbrailo%2Fnicolasbrailo.github.io%20sitesearch"
     onclick="togglesearch(); return false">Site search</a>
  <a class="is-center" href="/blog/series/">Series</a>
  <a class="is-center" href="/blog/projects.html">Projects</a>
  <a class="is-center" href="/blog/aboutme.html">About</a>
</div>

<form id="sitesearch" class="nav tabs is-full is-hidden">
  <input type="text" id="sitesearch_q"/>
  <button type="submit">Search</button>
</form>

</div>

<div id="content" class="language-clike">
<h2 name="scopeendinginc">Scope ending in C++</h2>

<div class="post_metadata">
Post by Nico Brailovsky @ 2015-03-31 |
  <a href="/blog/2015/0331_ScopeendinginC.html">Permalink</a> | <a href="/blog/2015/0331_ScopeendinginC.html">2 comments</a> |
  <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@md_blog/2015/0331_ScopeendinginC.md&body=I%20have%20a%20comment!">Leave a comment</a>
</div>

<div class="post">
<p>Is the following code valid C++?</p>
<pre lang="c++"><code class="language-c++" lang="c++">const int x = 42;
void f() {
    int x[x];
    x[24] = 0;
}
</code></pre>
<p>Unfortunately, it is. According to 3.3.2 in the standard, a definition is available in a child scope up to the point where it's shadowed, and that means "x" will first be interpreted as the global const int, being an index for a vector named "x". Any new references to "x" will point to the new declaration.</p>
<p>Fun stuff, right?</p>
</div>

<div class="post_comments">
<hr />
<h2>In reply to this post, Jason Turner commented @ 2015-04-08T14:30:09.000+02:00:<a name="inreplytothispostjasonturnercommented20150408t143009.0000200"></a></h2>
<p>It's issues like this that make me recommend enabling warnings of shadow variables, if your compiler supports it (https://github.com/lefticus/cppbestpractices/blob/master/02-Use_the_Tools_Available.md#compilers)</p>
<p>Original <a href="/blog/2015/0331_ScopeendinginC.html">published here</a>.</p>
<hr />
<h2>In reply to this post, <a href="/blog/aboutme.html">nico</a> commented @ 2015-04-08T14:42:53.000+02:00:<a name="inreplytothispostnicoblogaboutme.htmlcommented20150408t144253.0000200"></a></h2>
<p>This weird construct actually has a good reason to be, as someone pointed out to me in twitter, namely to be used when writing constructors. So, while it has some reasonable use cases it can also be abused in amusing and unexpected ways. And indeed we should rely in our tools to let us know when we do this kind of things.</p>
<p>Original <a href="/blog/2015/0331_ScopeendinginC.html">published here</a>.</p>
</div>

</div>

<div id="sitefooter">
   |
  <a href="/blog/history.html">Archive</a> |
  <a href="/blog/rss.xml">RSS</a>
</div>

<script src="/search.js"></script>
<script src="/codehighlight.js"></script>

</body>
</html>

<!DOCTYPE html>
<html>
<head>

<link rel="icon" href="favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<title>Nico Brailovsky's blog</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/style.css">
</head>

<body>

<div id="siteheader">
<h1>Nico Brailovsky's blog</h1>

<div class="nav tabs is-full">
  <a class="is-center" href="/">Home</a>
  <a class="is-center" href="/blog/index.html">Blog</a>
  <a class="is-center"
     href="https://github.com/search?type=code&q=repo%3Anicolasbrailo%2Fnicolasbrailo.github.io%20sitesearch"
     onclick="togglesearch(); return false">Site search</a>
  <a class="is-center" href="/blog/history.html">Archive</a>
  <a class="is-center" href="/series.html">Series</a>
  <a class="is-center" href="/projects.html">Projects</a>
  <a class="is-center" href="/about.html">About</a>
</div>

<div id="sitesearch" class="nav tabs is-full is-hidden">
  <input type="text" id="sitesearch_q"/>
  <button onclick="dosearch()">Search</button>
</div>

</div>

<div id="content" class="language-clike">
<h1>Scope ending in C++<a name="scopeendinginc"></a></h1>
<p>Is the following code valid C++?</p>
<pre lang="c++"><code class="language-c++" lang="c++">const int x = 42;
void f() {
    int x[x];
    x[24] = 0;
}
</code></pre>
<p>Unfortunately, it is. According to 3.3.2 in the standard, a definition is available in a child scope up to the point where it's shadowed, and that means "x" will first be interpreted as the global const int, being an index for a vector named "x". Any new references to "x" will point to the new declaration.</p>
<p>Fun stuff, right?</p>
<h1>Comments<a name="comments"></a></h1>
<hr />
<h2>In reply to <a href="">this post</a>, Jason Turner commented @ 2015-04-08T14:30:09.000+02:00:<a name="inreplytothispostjasonturnercommented20150408t143009.0000200"></a></h2>
<p>It's issues like this that make me recommend enabling warnings of shadow variables, if your compiler supports it (https://github.com/lefticus/cppbestpractices/blob/master/02-Use_the_Tools_Available.md#compilers)</p>
<p>Original <a href="/blog/2015/0331_ScopeendinginC.html">published here</a>.</p>
<hr />
<h2>In reply to <a href="">this post</a>, <a href="/blog_md">nicolasbrailo</a> commented @ 2015-04-08T14:42:53.000+02:00:<a name="inreplytothispostnicolasbrailoblog_mdcommented20150408t144253.0000200"></a></h2>
<p>This weird construct actually has a good reason to be, as someone pointed out to me in twitter, namely to be used when writing constructors. So, while it has some reasonable use cases it can also be abused in amusing and unexpected ways. And indeed we should rely in our tools to let us know when we do this kind of things.</p>
<p>Original <a href="/blog/2015/0331_ScopeendinginC.html">published here</a>.</p>
<hr />
<p>Post by Nico Brailovsky @ 2015-03-31 -
    <a href="/blog/2015/0331_ScopeendinginC.html">Permalink</a> -
    <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog_md/2015/0331_ScopeendinginC.md&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
</div>

<div id="sitefooter">
Page generated 2024-02-19
</div>

<script src="/search.js"></script>
<script src="/codehighlight.js"></script>

</body>
</html>

<!DOCTYPE html>
<html>
<head>

<link rel="icon" href="/favicon.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<title> Nico Brailovsky's thought repository</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/style.css">
</head>

<body>

<div id="siteheader">
  <h1>Nico Brailovsky's thought repository</h1>

<div class="nav tabs is-full">
  <a class="is-center" href="/blog/index.html">Blog</a>
  <a class="is-center"
     href="https://github.com/search?type=code&q=repo%3Anicolasbrailo%2Fnicolasbrailo.github.io%20"
     onclick="togglesearch(); return false">Site search</a>
  <a class="is-center" href="/blog/projects_texts">Projects & Texts</a>
  <a class="is-center" href="/blog/aboutme.html">About</a>
</div>

<form id="sitesearch" class="nav tabs is-full is-hidden">
  <input type="text" id="sitesearch_q"/>
  <button type="submit">Search</button>
</form>

</div>

<div id="content" class="language-clike">
<h2></h2>

<h2>Translated to Chinese!<a name="translatedtochinese"></a></h2>
<p>Post by Nico Brailovsky @ 2023-01-14 | <a href="/blog/2023/0114_TranslatedtoChinese.html">Permalink</a>  | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2023/0114_TranslatedtoChinese.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>Small celebratory post, because I never expected it:</p>
<p><a href="/blog_img/212446793-30c64252-a788-4a6d-81e2-e8f05f126497.jpg"><img alt="" src="/blog_img/212446793-30c64252-a788-4a6d-81e2-e8f05f126497.jpg" /></a></p>
<p>Someone translated <a href="http://github.com/nicolasbrailo/pianOli">one of my open source projects</a> to Chinese!</p>
<hr />
<h2>Bash script preamble<a name="bashscriptpreamble"></a></h2>
<p>Post by Nico Brailovsky @ 2021-06-27 | <a href="/blog/2021/0627_Bashscriptpreamble.html">Permalink</a>  | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2021/0627_Bashscriptpreamble.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>All background Bash scripts should start with this preamble:</p>
<pre lang="bash"><code class="language-bash" lang="bash">set -euo pipefail
exec &gt; ~/log.log 2&gt;&amp;1
</code></pre>
<p>There are countless articles explaining why, and the main purpose of this one is a reminder for myself, so I won't go into the details. For reference:</p>
<ul>
<li><strong>-e</strong> halts the script on error</li>
<li><strong>-u</strong> errors when using an undefined variable</li>
<li><strong>-o pipefail</strong> makes pipe error return value sane</li>
<li><strong>exec &gt; ~/log.log 2&gt;&amp;1</strong> redirect all output to ~/log.log</li>
</ul>
<hr />
<h2>Where is the fun in that?<a name="whereisthefuninthat"></a></h2>
<p>Post by Nico Brailovsky @ 2021-03-18 | <a href="/blog/2021/0318_Whereisthefuninthat.html">Permalink</a>  | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2021/0318_Whereisthefuninthat.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>You can always find coders asking why coding isn't fun anymore. I can somewhat relate but I never understood why the answer isn't obvious: coding isn't software engineering. When you go from coding to engineering, the focus changes. A lot of the interesting stuff is there, but there's also not-interesting-stuff in the mix. Maybe testing and documenting isn't your thing, you just want to build something. Maybe the stability from testing and documenting isn't that important to you. Perhaps you know you're the only one who's ever going to read your code. Your future self may be angry at you for a little while if the code breaks... so what? Your experiment crashed? Just reboot it. No problem.</p>
<p>If you're coding-to-sell, you're not writing code for yourself. You write for a team, even if that team is only you and future-you. You write it so it may scale and adapt to new requirements. You write it to survive a bit more than a weekend, and to be stable. You're not writing code to learn new things, that's only a nice side-effect; you are trying to build a product.</p>
<p>Furthermore, you're not investing time to learn something or just to have fun; you're trading time for money (if you learn something in the process, that's good - but probably not why you're being paid a salary as a software engineer).</p>
<p>It's understandable that parts of software engineering are not as fun as it was hacking in a basement while you were a kid. There is still a very big overlap, but it's not just the same activity. Myself, I try to focus on the fun parts and just have discipline to get the boring parts out of the way. I usually work in places where the balance is fairly decent, and it's kept me interested in software development for the last 15 (ish) years. I'm hoping it'll do the trick for much longer than that.</p>
<hr />
<h2>reboot succesful?<a name="rebootsuccesful"></a></h2>
<p>Post by Nico Brailovsky @ 2021-03-17 | <a href="/blog/2021/0317_rebootsuccesful.html">Permalink</a>  | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2021/0317_rebootsuccesful.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>Since "migrating" from Wordpress to Blogspot:</p>
<ul>
<li>Traffic to Wordpress fell from ~100ish visitors a day to ~30 or ~40ish.</li>
<li>This site went from 0 to also ~30 or ~40ish.</li>
</ul>
<p>That went much better than I expected, considering I couldn't set up a proper HTTP301-permanently moved (WP charges you for that, which IMO is slight extortionate for a site I don't want to monetize). Let's see how it goes 10 years from now, when I have to migrate from Blogpost to something else.</p>
<hr />
<h2>sudo reboot<a name="sudoreboot"></a></h2>
<p>Post by Nico Brailovsky @ 2021-03-02 | <a href="/blog/2021/0302_sudoreboot.html">Permalink</a>  | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2021/0302_sudoreboot.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>Recently found out Wordpress had pretty aggressive ads on my blog. That worked as the encouragement I was needing to work on a task I'd been putting off for years: fix bit-rotted content! I took the opportunity to fix all (most) broken links and source code snippets from the last 14 years. It was supposed to be a short sed script, which of course ended up being 3 days of work - a lot of it manual. A few cool things I figured doing this:</p>
<ul>
<li>Even if I very sparingly add new posts, 14 years is still a lot of content. By the infinite monkey theorem, some of it should be good. Right?</li>
<li>A new reason to dislike template metaprogramming: so many 'template &amp; lt; class &amp; gt;', so much broken code...</li>
<li>I have 400+ posts and less than 10 images. While I quite like adding visual content, very little of it (except memes!) survived the successive blog migrations.</li>
<li>I can estimate there have been at least 3 platform migrations since the first post. I can count the number of times that '&lt;' gets html-encoded like the rings of a tree. '&amp; amp;amp;lt;' was the longest encode sequence I found.</li>
</ul>
<hr />
<h2>Vimtip: Open path<a name="vimtipopenpath"></a></h2>
<p>Post by Nico Brailovsky @ 2020-05-08 | <a href="/blog/2020/0508_VimtipOpenpath.html">Permalink</a>  | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2020/0508_VimtipOpenpath.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>If you are editing a file which references another file (like, say, a cpp file #including a header file) then you can use Vim to open the referenced file in a new tab like this:</p>
<pre lang="c++"><code class="language-c++" lang="c++">#include "foo/bar.h"
</code></pre>
<p>Place your cursor anywhere in "foo/bar.h" and press <code>gf</code> to open the referenced path. More interestingly, you can also do <code>C-w</code>, release and then <code>gf</code> to open in a new tab.</p>
<p>Today I learned you can also do this for arbitrary URLs. If you have a file like this:</p>
<pre lang="c++"><code class="language-c++" lang="c++">#include "foo/bar.h"
// https://github.com/nicolasbrailo/Nico.rc/blob/master/README.md
...
</code></pre>
<p>Then you can do <code>C-w gf</code> on either of the first two lines! If needed, Vim will automatically fetch the referenced url for you and store it in a temp location. Magic!</p>
<hr />
<h2>Weak symbols to mock c-APIs with gmock/gtest<a name="weaksymbolstomockcapiswithgmockgtest"></a></h2>
<p>Post by Nico Brailovsky @ 2020-03-15 | <a href="/blog/2020/0315_WeaksymbolstomockcAPIswithgmockgtest.html">Permalink</a>  | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2020/0315_WeaksymbolstomockcAPIswithgmockgtest.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>I recently worked with a c-style API interface which wasn't very open to mocking. The API in question looked something like this:</p>
<pre lang="c++"><code class="language-c++" lang="c++">handle_t h = api_open();
api_foo(h, param1, param2);
api_foo2(h, 42);
api_close(h);
</code></pre>
<p>This *almost* looks like a C++ interface, with extra steps that make it really really hard to mock (and, thus, to test). If it were a c++ interface, it would be possible to "virtualize" the different methods from the, even if this required a bit of patching to the original library. While a c interface doesn't provide this facility, there is another feature that makes mocking such an API with gmock possible: linker weak symbols!</p>
<p>In the header, you can patch your target library to export its symbols like this:</p>
<pre lang="c++"><code class="language-c++" lang="c++">handle_t api_open() <strong>attribute</strong>((weak));
void api_foo(handle_t h, int, float) <strong>attribute</strong>((weak));
void api_foo2(handle_t h, int) <strong>attribute</strong>((weak));
void api_close(handle_t h) <strong>attribute</strong>((weak));
</code></pre>
<p>The <a href="https://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Function-Attributes.html">weak attribute</a> will tell the compiler to emit this symbol marked as 'w'. If you compile this library and inspect it with <code>nm</code>, you'll see the (possibly mangled) symbol name and a w next to it. In turn, this tells the linker that this symbol can be overridden.</p>
<p>Normally, if you define 'api_open' in more than a single .object file, and then link them all in a single binary, you'll end up with a linker error. Something about "multiple symbol definition", which seems reasonable. If the symbols are instead marked as weak, then the compiler will simply override the symbol table with the last seen instance of that symbol.</p>
<p>Once all mock-able symbols are defined as week, creating a mock is "easy", albeit not necessarily pretty. Following the example:</p>
<pre lang="c++"><code class="language-c++" lang="c++">// Mock definition
struct MockApi {
 public:
  MOCK_METHOD(handle_t, api_open, ());
  MOCK_METHOD(void, api_foo, (handle_t h, int, float));
  MOCK_METHOD(void, api_foo2, (handle_t h, int));
  MOCK_METHOD(void, api_close, (handle_t h));
};
MockApi mocked_api_instance;
// Override default symbols and forward to gtest
handle_t api_open() { return mocked_api_instance.api_open(); }
handle_t api_api_foo(handle_t h, int i) { return mocked_api_instance.api_open(h, i); }
// ...
</code></pre>
<p>Note how mocked_api_instance has to be a global singleton; since your test under code will probably expect to be able to call this API directly, it's necessary to rely on a global object that everyone can access - both your test and their overridden API symbols and the module under test. With all this scaffolding in place, you can now write almost-normal tests.</p>
<pre lang="c++"><code class="language-c++" lang="c++">TEST(Foo, Bar) {
  EXPECT_CALL(mocked_api_instance, api_open).WillOnce(Return(nullptr));
  MyObject o;
  o.run_test();
}
</code></pre>
<p>This method has the (big) disadvantage of creating an invisible dependency between "mocked_api_instance" and the rest of the test. An out-of-order inclusion can make your test fail, unexpectedly, and people trying to write new tests will find it quite hard to understand what is going on with out some good docs. On the other hand, this technique will let you create very stable tests with few run-time dependencies, so I still believe they can add a lot of value for integration tests!</p>
<hr />
<h2>jq: grep and prettify json<a name="jqgrepandprettifyjson"></a></h2>
<p>Post by Nico Brailovsky @ 2020-02-27 | <a href="/blog/2020/0227_jqgrepandprettifyjson.html">Permalink</a> | <a href="/blog/2020/0227_jqgrepandprettifyjson.html">3 comments</a> | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2020/0227_jqgrepandprettifyjson.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>If you don't use <a href="https://stedolan.github.io/jq/manual/">jq</a>, you are missing a very important utility in your bash toolset. jq let's you query and filter json files from a cli. Just like awk or sed, js's "language" is basically write only, meaning whenever you need to do something there's a 99% chance you'll just be copy-pasting recipes from Stackoverflow until you find the one that works for you. Here are a couple of recipes I found most useful:</p>
<p><strong>cat a json file - with pretty print</strong></p>
<pre lang="c++"><code class="language-c++" lang="c++">jq . /path/to/json_file
</code></pre>
<p><strong>Select a single key</strong></p>
<pre lang="c++"><code class="language-c++" lang="c++">jq '.path.to.key'
</code></pre>
<p>The command above will return "42" for a json that looks like "{path: {to: {key: 42}}}"</p>
<p><strong>Delete all entries in an object, except for one</strong></p>
<pre lang="c++"><code class="language-c++" lang="c++">jq '.foo|=bar'
</code></pre>
<p>The command above will return "{foo: {bar:''}}" for a json that looks like "{foo: {bar:'', baz: ''}}"</p>
<p>This is probably not even enough to get started. Luckily there's plenty of docs to read @ <a href="https://stedolan.github.io/jq/manual/">https://stedolan.github.io/jq/manual/</a></p>
<hr />
<h2>Mixin(ish) classes with parameter packs in C++<a name="mixinishclasseswithparameterpacksinc"></a></h2>
<p>Post by Nico Brailovsky @ 2020-02-18 | <a href="/blog/2020/0218_MixinishclasseswithparameterpacksinC.html">Permalink</a> | <a href="/blog/2020/0218_MixinishclasseswithparameterpacksinC.html">2 comments</a> | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2020/0218_MixinishclasseswithparameterpacksinC.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>For some reason I couldn't find many examples of how to use a parameter pack as a mixin, to enable different features with no runtime overhead. Here is a full example of you might implement this (be aware there are some nasal daemons in the code below!). The technique is really based on this one line:</p>
<pre lang="c++"><code class="language-c++" lang="c++"> int dummy[sizeof...(Config)] = { (Config::apply(p), 0)... };
</code></pre>
<p>This idiom will unpack a parameter pack and call T::apply, for each T in the parameter pack. You can use this idiom to build very clean mixin-type interfaces with static dispatch, or to build job security.</p>
<p>Full example:</p>
<pre lang="c++"><code class="language-c++" lang="c++">struct EnableFeatureA {
  template &lt;typename T&gt; static void apply(T *a) {
    cout &lt;&lt; a-&gt;a() &lt;&lt; endl;
  }
};
struct EnableFeatureB {
  template &lt;typename T&gt; static void apply(T *a) {
    cout &lt;&lt; T::b() &lt;&lt; endl;
  }
};
template &lt;typename Impl, typename... Config&gt;
struct Foo {
  Foo(){
    // Call apply() for each type in Config
    Impl *p = nullptr;
    int dummy[sizeof...(Config)] = { (Config::apply(p), 0)... };
  }
};
struct Bar;
using FwdFoo = Foo&lt;Bar, EnableFeatureA, EnableFeatureB&gt;;
struct Bar : FwdFoo {
   int a() { return 4; }
   static int b() { return 2; }
};
</code></pre>
<hr />
<h2>Presenting tips: make your presentations suck a bit less<a name="presentingtipsmakeyourpresentationssuckabitless"></a></h2>
<p>Post by Nico Brailovsky @ 2019-11-11 | <a href="/blog/2019/1111_Presentingtipsmakeyourpresentationssuckabitless.html">Permalink</a>  | <a href="https://github.com/nicolasbrailo/nicolasbrailo.github.io/issues/new?title=Comment@/blog/2019/1111_Presentingtipsmakeyourpresentationssuckabitless.html&amp;body=I%20have%20a%20comment!">Leave a comment</a></p>
<p>I spent the last few years in a role that required a significant part in communicating with other people. Some of that in the form of slides and presentations, because not having slides isn't enterprisy. I'm far from being a great presenter, but I did learn a thing or two. All this is quite general, so it should apply to any kind of topic... as long as that topic is software engineering. I'm still a technical person and an engineer, so a lot of my assumptions about the audience may not hold true if you, for example, need to seriously consider fun things like workplace politics.</p>
<p>I hope these tips become useful for other people. At the very least I hope I'll remember to re-read this post the next time I have to present something.</p>
<h2>Tip 1: Your audience wants you to succeed<a name="tip1youraudiencewantsyoutosucceed"></a></h2>
<p>This is perhaps the most groundbreaking revelation. When you present something, people are giving you their time. Instead of browsing memes they are sitting down, listenning to what you have to say (at least until their limited attention span runs out). Nearly all of your audience will want to learn something, have fun, or at least be entretained. In a large enough crowd, the majority will be there voluntarily. There is just one logical conclusion: they want you to succeed! Few will go there with the expectation that your presentation will suck; that would be wasted time for them too.</p>
<h2>Tip 2: Your audience wants you to succeed. Except for *that person*.<a name="tip2youraudiencewantsyoutosucceed.exceptforthatperson."></a></h2>
<p>Ok, tip #1 needs a caveat: *that person*. Most people will want to enjoy your presentation as much as they can and move on to the next thing. Except there will always be that person. You know who; might just be schadenfreude, or maybe they like showing off "they know best". Whatever the reason, they'll have a nitpick, an impossible question or an "actually" to add. There's good news, though: everyone dislikes him!</p>
<p>Whenever the annoying person of the group raises their hand, there's usually a collective sigh and a lot of eye-rolling in the audience. Don't invest most of your energy in dealing with that person. Do pay attention to the issues this person raises; they may in fact be good objections. Just learn how to defer. 99% of the time it suffices to say "good observation, let's pick it up one-on-one after this presentation". The audience is happy, the person raising the question feels heard and you may actually learn something new from the interaction.</p>
<h2>Tip 3: Understand your medium<a name="tip3understandyourmedium"></a></h2>
<p>A long time ago I thought slides were slides were slides. And a presentation is the decoration on top. Big mistake! The first thing I learned -the hard way- is that presentations, and in particular slides, need to be tailored to your delivery medium. Doing an online webcast presentation is very different than doing a presentation in person. It's even harder if you have a mixed audience, with some people online and some people in person. I personally try to avoid this situation like hell, as the end result tends to be a session that's not quite good for anyone. I prefer to have two sessions, one in person only and one just online. Some people are capable of having a successful presentation with a mixed audience. I'm not that skilled.</p>
<h2>Tip 4: Give your audience a break<a name="tip4giveyouraudienceabreak"></a></h2>
<p>You know your presentation. You've practiced, know the material, understand every nook and cranny of your talk. However, for your audience it's (hopefully) all new knowledge. And it's hard to absorb new knowledge with a person talking non stop, all the time. Give your audience a pause. Let them think. *Stay silent*.</p>
<p>It sounds scary: being on the spotlight, standing up and not saying anything for *minutes*. Well, it may seem like minutes, but it's usually just a few seconds you need: that's usually enough for people to think through a new idea. Learn to be comfortable with a bit of silence.</p>
<h2>Tip 5: Silence for emphasis<a name="tip5silenceforemphasis"></a></h2>
<p>Silence is important, so it gets two tips. People need silence to think, sure. But also consider this: while you shut up, people think of what you last said (or dinner, depending on the talk). That means, if you need to emphazise a particular aspect of your talk don't repeat it over and over again; present it, then make a pause. Just 5 seconds. If you quickly move on it becomes another bit of information in a sea of new knowledge. Stop for emphasis.</p>
<h2>Tip 6: Questions?<a name="tip6questions"></a></h2>
<p>In light of all the praise of silence, here's an extra beneffit of shutting up: people get to ask questions. Yes, that's also scary, but interaction is great to help people understand. Invite questions with your silence!</p>
<p>Yes, an open conversation is scary. Besides the job of presenting you're now also a moderator. It can derail the whole timing and it makes presenting that much harder. So what? Your presentation may be good but it's not *that good*: if your audience engages you're doing something right. Follow their lead.</p>
<p>The difficult part is learning when to stop a runaway discussion. As a general rule, if you see engagement from different people across the room you're doing fine. If you only see a small group of people nitpicking over a detail, it's time to stop (remember tip #2!)</p>
<h2>Tip 7: Most important slide? Last one<a name="tip7mostimportantslidelastone"></a></h2>
<p>The last slide will be shown the longest. While you get closing questions from the audience (or akwardly stand in a corner while saying "no questions?", whichever happens) the final slide will be on screen. People will now either stare at their phones or ar this final slide. Make it count! Don't use a "Questions?" clipart (please don't use clipart). Make the last slide a summary of the most relevant point of your talk. Add some followup links and contact information.</p>
<p>If there is only one slide your audience will remember (and you may not even get that) it will probably be the last one.</p>
<h2>Tip 8: Paper drafts<a name="tip8paperdrafts"></a></h2>
<p>Some times a computer is too limiting. Start with a paper draft to organize your ideas. Maybe you can also draw a mock of a few important slides. You don't need to design the entire thing on paper but by not having to fight your tools (is this image *really* aligned with that text?) you can focus on content, then on "UX" and only then on the implementation. If you run out of time battling powerpoint you can still have good content. If you run out of time battling powerpoint while designing your third slide, you may have a brilliant presentation with 10% of the content you wanted to show.</p>
<h2>Tip 9: Know your audience *and yourself*<a name="tip9knowyouraudienceandyourself"></a></h2>
<p>Some presentations are good for jokes and an informal tone. Some are to present quarterly financial numbers to your board of directors. It's pretty clear in which one you can use cat memes (and if it's not, maybe you need to start smaller!) - but you should also know to which style of presentation you naturally lean.</p>
<p>Slides are boring but safe. Q&amp;A's are good to let people understand a topic at their own pace. Videos are a safe back up, but hard to seamlessly integrate in a presentation. Jokes are great, but really hard if you're not familiar with the audience. Know which style works for you and rely on it; but also try to mix in some new skill you are trying to develop. You may be surprised.</p>
<h2>Tip 10: Why are you there? Why are they there?<a name="tip10whyareyoutherewhyaretheythere"></a></h2>
<p>Before even planning a presentation, ask yourself: why? What's the purpose, what do *I* want to get out of it? More importantly: what do other people get out of it? The first reaction is usually "sharing information!". Unless you are a particularly skilled presenter, the information you had to share can probably be better understood by writing down a whitepaper, or maybe just an email.</p>
<p>There are many reasons to present something, from getting people to sit-down-and-pay-attention to "listen to my amazing sales pitch". In the end most of them boil down to some form of entertainment. Yes: most (successful) presentations are just some form of amusement. If you also have a useful message to deliver with it, all the better!</p>
<hr />

</div>

<div id="sitefooter">
  <a href="/blog/index.html">Prev</a> | <a href="/blog/index2.html">Next</a> |
  <a href="/blog/history.html">Archive</a> |
  <a href="/blog/rss.xml">RSS</a>
</div>

<script src="/search.js"></script>
<script src="/codehighlight.js"></script>

</body>
</html>
